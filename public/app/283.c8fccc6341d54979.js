"use strict";(self.webpackChunkBRP=self.webpackChunkBRP||[]).push([[283],{4283:(E,m,a)=>{a.r(m),a.d(m,{ChatModule:()=>S});var h=a(6814),g=a(2064),d=a(5861),t=a(5879),p=a(9862),f=a(6973),M=a(305),C=a(7398),y=a(6306);let x=(()=>{class s{constructor(e){this.http=e,this.apiUrl="http://brp/api/ai/chat"}sendMessageSync(e){var n=this;return(0,d.Z)(function*(){const c=new p.WM({"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"false","Access-Control-Allow-Headers":"Content-Type","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE"}),r={message:e};console.log("API",n.apiUrl),console.log("BODY",r);try{return yield function v(s,o){const e="object"==typeof o;return new Promise((n,c)=>{const r=new M.Hp({next:i=>{n(i),r.unsubscribe()},error:c,complete:()=>{e?n(o.defaultValue):c(new f.K)}});s.subscribe(r)})}(n.http.post(n.apiUrl,r,{headers:c,responseType:"text"}).pipe((0,C.U)(P=>P.split("\n").map(u=>JSON.parse(u)).map(u=>u.response).join(""))))}catch(i){throw console.error("Erro ao enviar mensagem:",i),i}})()}sendMessage(e){const n=new p.WM({"Content-Type":"application/json"});return this.http.post(this.apiUrl,{model:"llama3",prompt:e},{headers:n,responseType:"text"}).pipe((0,C.U)(r=>{try{return JSON.parse(r)}catch(i){return console.error("Falha ao fazer parse da resposta:",i),r}}),(0,y.K)(r=>{throw console.error("Erro ao enviar mensagem:",r),r}))}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(p.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var l=a(95);function T(s,o){if(1&s&&(t.TgZ(0,"div",6)(1,"strong"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&s){const e=o.$implicit;t.xp6(2),t.hij("",e.user,":"),t.xp6(1),t.hij(" ",e.text," ")}}const A=[{path:"",component:(()=>{class s{constructor(e){this.chatService=e,this.messages=[],this.userMessage=""}sendMessage(){var e=this;return(0,d.Z)(function*(){if(e.userMessage.trim()){e.messages.push({user:"Voc\xea",text:e.userMessage});try{const n=yield e.chatService.sendMessageSync(e.userMessage);console.log(n),e.messages.push({user:"Ollama",text:n})}catch{e.messages.push({user:"Ollama",text:"Erro ao processar a mensagem."})}e.userMessage=""}})()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(x))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-home-chat"]],decls:7,vars:2,consts:[[1,"chat-container"],[1,"messages"],["class","message",4,"ngFor","ngForOf"],[1,"input-container"],["placeholder","Digite sua mensagem...",3,"ngModel","ngModelChange"],[3,"click"],[1,"message"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,T,4,2,"div",2),t.qZA(),t.TgZ(3,"div",3)(4,"input",4),t.NdJ("ngModelChange",function(r){return n.userMessage=r}),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){return n.sendMessage()}),t._uU(6,"Enviar"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.messages),t.xp6(2),t.Q6J("ngModel",n.userMessage))},dependencies:[h.sg,l.Fj,l.JJ,l.On],styles:[".chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;border:1px solid #ccc;padding:10px}.messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;margin-bottom:10px}.message[_ngcontent-%COMP%]{margin-bottom:5px}.input-container[_ngcontent-%COMP%]{display:flex}input[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:16px}button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;cursor:pointer}"]}),s})()}];let O=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[g.Bz.forChild(A),g.Bz]}),s})(),S=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[h.ez,O,l.u5]}),s})()}}]);